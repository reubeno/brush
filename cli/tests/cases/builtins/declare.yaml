name: "Builtins: declare"
cases:
  - name: "Dump vars"
    stdin: |
      declare myvar=something
      declare -p myvar

      myarr=(a b c)
      declare -p myarr

  - name: "Declare integer"
    stdin: |
      declare -i num=10
      echo $num
      num+=10
      echo $num

  - name: "Declare readonly variable"
    ignore_stderr: true
    stdin: |
      declare -r var="readonly"
      echo $var
      var="change"

  - name: "Declare array"
    stdin: |
      declare -a arr=("element1" "element2" "element3")
      declare -p arr
      echo "[0]: ${arr[0]}"
      echo "[1]: ${arr[0]}"
      echo "[2]: ${arr[0]}"
      echo "[3]: ${arr[0]}"
      echo "STAR: ${arr[*]}"
      echo "AT: ${arr[*]}"

  - name: "Declare associative array"
    stdin: |
      declare -A arr=(["x1"]=1 ["x2"]=2)
      declare -p arr
      echo "[x]: ${arr[x1]}"
      echo "[y]: ${arr[x2]}"
      echo "[z]: ${arr[x3]}"
      echo "STAR: ${arr[*]}"
      echo "AT: ${arr[*]}"

  - name: "Declare and export variable"
    stdin: |
      declare -x myexportedvar="exported variable"
      env | grep myexportedvar

  - name: "Re-declaring variable"
    stdin: |
      var="value"
      declare var
      echo "var: ${var}"

  - name: "Declaring without value"
    stdin: |
      [[ -v var ]] && echo "1: Variable is set"
      declare var
      declare -p var
      [[ -v var ]] && echo "2: Variable is set"
      declare var2=""
      declare -p var2
      [[ -v var2 ]] && echo "3: Variable is set"
