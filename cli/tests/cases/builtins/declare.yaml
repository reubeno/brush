name: "Builtins: declare"
cases:
  - name: "Dump vars"
    stdin: |
      declare myvar=something
      declare -p myvar

      myarr=(a b c)
      declare -p myarr

  - name: "Declare integer"
    known_failure: true
    stdin: |
      declare -i num=10
      echo $num
      num+=10
      echo $num

  - name: "Declare readonly variable"
    known_failure: true
    stdin: |
      declare -r var="readonly"
      echo $var
      var="change"

  - name: "Declare array"
    known_failure: true
    stdin: |
      declare -a arr=("element1" "element2" "element3")
      echo ${arr[*]}

  - name: "Declare associative array"
    known_failure: true
    stdin: |
      declare -A arr=(["x"]=1 ["y"]=2)
      echo ${arr["x"]}
      echo ${arr["y"]}

  - name: "Declare and export variable"
    stdin: |
      declare -x myexportedvar="exported variable"
      env | grep myexportedvar

  - name: "Re-declaring variable"
    stdin: |
      var="value"
      declare var
      echo "var: ${var}"

  - name: "Declaring without value"
    known_failure: true
    stdin: |
      [[ -v var ]] && echo "1: Variable is set"
      declare var
      [[ -v var ]] && echo "2: Variable is set"
      declare var2=""
      [[ -v var2 ]] && echo "3: Variable is set"
