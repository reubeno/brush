name: "Functions"
cases:
  - name: "Basic function invocation"
    test_files:
      - path: "script.sh"
        contents: |
          myfunc() {
              echo "In myfunc()."
          }
          echo "Calling myfunc()..."
          myfunc
          echo "Returned."
    args: ["./script.sh"]

  - name: "Function invocation with args"
    test_files:
      - path: "script.sh"
        contents: |
          myfunc() {
              echo "In myfunc()"
              echo "1: $1"
              echo "*: $*"
          }
          echo "Calling myfunc()..."
          myfunc a b c
          echo "Returned."
    args: ["./script.sh"]

  - name: "Return in function"
    test_files:
      - path: "script.sh"
        contents: |
          myfunc() {
              echo "In myfunc()"
              return 5
              echo "Should not get here"
          }
          echo "Calling myfunc()..."
          myfunc
          echo "Returned: $?"
    args: ["./script.sh"]

  - name: "Function definition with output redirection"
    stdin: |
      myfunc() {
          echo "In myfunc()"
      } >>./test.txt

      myfunc
      myfunc
